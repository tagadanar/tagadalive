include('API/compatibility')

include('Model/GameObject/Cell')
include('Model/GameObject/Entity')
include('Model/GameObject/EntityEffect')
include('Model/GameObject/TargetType')
include('Model/GameObject/ItemEffect')
include('Model/GameObject/Item')

include('Model/Const/Stats')

include('Controlers/Fight')
include('Controlers/Board')
include('Controlers/Items')

include('Controlers/Maps/MapPath')
include('Controlers/Maps/MapDanger')
include('Controlers/Maps/MapPosition')
include('Controlers/Maps/MapAction')
include('Controlers/Maps/MapOpportunity')

//include('Model/Combos/Jump')
include('Model/Combos/Danger')
include('Model/Combos/Position')
include('Model/Combos/Action')
include('Model/Combos/Consequences')
include('Model/Combos/Combo')
include('Model/Combos/EffectOverTime')

// Effect handlers - must be included AFTER Consequences (they register handlers)
include('Model/Combos/Effects/DamageEffects')
include('Model/Combos/Effects/HealEffects')
include('Model/Combos/Effects/ShieldEffects')
include('Model/Combos/Effects/BuffEffects')
include('Model/Combos/Effects/DebuffEffects')
include('Model/Combos/Effects/UtilityEffects')
include('Model/Combos/Effects/MovementEffects')
include('Model/Combos/Effects/PassiveEffects')

include('Services/Damages')
include('Services/Targets')
include('Services/Sort')
include('Services/Benchmark')


include('AI/ScoringConfig')
include('AI/EntityCoefs')
include('AI/BattleState')
include('AI/ScoringModifiers')
include('AI/Scoring')
include('AI/Opportunity')

// Search algorithms
include('AI/Algorithms/MCTS')
include('AI/Algorithms/BeamSearch')
include('AI/Algorithms/PTS')
include('AI/Algorithms/CalibratedPTS')  // Must be before UnifiedMCTS (dependency)
include('AI/Algorithms/UnifiedMCTS')
include('AI/Algorithms/CellMCTS')
include('AI/Algorithms/OpportunityMCTS')
include('AI/Algorithms/Hybrid')
include('AI/Algorithms/ActionKnapsack')
include('AI/Algorithms/ComboExplorer')

include('AI/AI')



function init() {
	Benchmark.initTurn()
	Benchmark.start('init')
	if(getTurn()==1) {
		Benchmark.start('Map.init')
		Board.init()
		Benchmark.stop('Map.init')

		Benchmark.start('Items.init')
		Items.init()
		Benchmark.stop('Items.init')
	}
	Benchmark.start('MapPath.refresh')
	MapPath.refresh()
	Benchmark.stop('MapPath.refresh')

	Benchmark.start('Fight.refresh')
	Fight.refresh()
	Benchmark.stop('Fight.refresh')
	Benchmark.updateContext()

	Benchmark.start('Map.refresh')
	Board.refresh()  // Note: Board.refresh() internally calls Fight.refreshEntities()
	Benchmark.stop('Map.refresh')

	Benchmark.start('Scoring.refresh')
	Scoring.refresh()
	Benchmark.stop('Scoring.refresh')

	Benchmark.start('MapDanger.refresh')
	MapDanger.refresh()
	Benchmark.stop('MapDanger.refresh')

	// Compute ally danger after MapDanger (depends on danger maps)
	BattleState.computeAllAllyDanger()

	Benchmark.start('MapPosition.refresh')
	MapPosition.refresh()
	Benchmark.stop('MapPosition.refresh')

	Benchmark.start('MapAction.refresh')
	MapAction.refresh()
	Benchmark.stop('MapAction.refresh')

	Benchmark.start('MapOpportunity.refresh')
	MapOpportunity.refresh()
	Benchmark.stop('MapOpportunity.refresh')

	Benchmark.stop('init')
}
